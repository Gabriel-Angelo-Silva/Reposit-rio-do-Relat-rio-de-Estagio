let
    Fonte = Excel.Workbook(File.Contents("C:\Users\xxxxxxxx\Documents\My SAS Files\FERIAS E LP\SGPTB19_OUTRO_AFASTAMENTO.xlsx"), null, true),
    SGPTB19_OUTRO_AFASTAMENTO_Sheet = Fonte{[Item="SGPTB19_OUTRO_AFASTAMENTO",Kind="Sheet"]}[Data],
    #"Cabeçalhos Promovidos" = Table.PromoteHeaders(SGPTB19_OUTRO_AFASTAMENTO_Sheet, [PromoteAllScalars=true]),
    #"Tipo Alterado" = Table.TransformColumnTypes(#"Cabeçalhos Promovidos",{{"NUMR_SEQ_OUTRO_AFASTAMENTO", Int64.Type}, {"SGPBT06_NUMR_MATR_SERV", Int64.Type}, {"DATA_PUBLICACAO_DOE", type datetime}, {"DATA_INIC_LICENCA", type datetime}, {"DATA_FIM_LICENCA", type datetime}, {"TIPO_AFASTAMENTO", Int64.Type}, {"DESC_OBSERVACAO", type text}, {"CODG_SITUACAO_REGISTRO", Int64.Type}, {"QTDE_MESES", Int64.Type}, {"NUMR_PROCESSO", type text}, {"DATA_ATUALIZACAO_BD", type datetime}}),
    #"Tipo Alterado1" = Table.TransformColumnTypes(#"Tipo Alterado",{{"DATA_PUBLICACAO_DOE", type date}, {"DATA_INIC_LICENCA", type date}, {"DATA_FIM_LICENCA", type date}, {"DATA_ATUALIZACAO_BD", type date}}),
    #"Linhas Classificadas" = Table.Sort(#"Tipo Alterado1",{{"DATA_ATUALIZACAO_BD", Order.Descending}, {"DATA_INIC_LICENCA", Order.Descending}}),
    #"Colunas Reordenadas" = Table.ReorderColumns(#"Linhas Classificadas",{"SGPBT06_NUMR_MATR_SERV", "NUMR_SEQ_OUTRO_AFASTAMENTO", "DATA_PUBLICACAO_DOE", "DATA_INIC_LICENCA", "DATA_FIM_LICENCA", "TIPO_AFASTAMENTO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "QTDE_MESES", "NUMR_PROCESSO", "DATA_ATUALIZACAO_BD"}),
    #"Outras Colunas Removidas" = Table.SelectColumns(#"Colunas Reordenadas",{"SGPBT06_NUMR_MATR_SERV", "NUMR_SEQ_OUTRO_AFASTAMENTO", "DATA_INIC_LICENCA", "DATA_FIM_LICENCA", "TIPO_AFASTAMENTO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "QTDE_MESES", "NUMR_PROCESSO", "DATA_ATUALIZACAO_BD"}),
    #"Colunas Mescladas" = Table.CombineColumns(Table.TransformColumnTypes(#"Outras Colunas Removidas", {{"DATA_INIC_LICENCA", type text}, {"DATA_FIM_LICENCA", type text}}, "pt-BR"),{"DATA_INIC_LICENCA", "DATA_FIM_LICENCA"},Combiner.CombineTextByDelimiter(" - ", QuoteStyle.None),"Outras_Licenca"),
    #"Coluna Duplicada" = Table.DuplicateColumn(#"Colunas Mescladas", "Outras_Licenca", "Outras_Licenca - Copiar"),
    #"Colunas Reordenadas1" = Table.ReorderColumns(#"Coluna Duplicada",{"SGPBT06_NUMR_MATR_SERV", "NUMR_SEQ_OUTRO_AFASTAMENTO", "Outras_Licenca", "Outras_Licenca - Copiar", "TIPO_AFASTAMENTO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "QTDE_MESES", "NUMR_PROCESSO", "DATA_ATUALIZACAO_BD"}),
    #"Colunas Renomeadas" = Table.RenameColumns(#"Colunas Reordenadas1",{{"Outras_Licenca - Copiar", "Outras_Licenca_Ano"}}),
    #"Intervalo de Texto Extraído" = Table.TransformColumns(#"Colunas Renomeadas", {{"Outras_Licenca_Ano", each Text.Middle(_, 6, 4), type text}}),
    #"Coluna Duplicada1" = Table.DuplicateColumn(#"Intervalo de Texto Extraído", "Outras_Licenca", "Outras_Licenca - Copiar"),
    #"Coluna Duplicada2" = Table.DuplicateColumn(#"Coluna Duplicada1", "Outras_Licenca - Copiar", "Outras_Licenca - Copiar - Copiar"),
    #"Colunas Removidas" = Table.RemoveColumns(#"Coluna Duplicada2",{"Outras_Licenca - Copiar - Copiar"}),
    #"Colunas Reordenadas2" = Table.ReorderColumns(#"Colunas Removidas",{"Outras_Licenca - Copiar", "SGPBT06_NUMR_MATR_SERV", "NUMR_SEQ_OUTRO_AFASTAMENTO", "Outras_Licenca", "Outras_Licenca_Ano", "TIPO_AFASTAMENTO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "QTDE_MESES", "NUMR_PROCESSO", "DATA_ATUALIZACAO_BD"}),
    #"Dividir Coluna por Delimitador" = Table.SplitColumn(#"Colunas Reordenadas2", "Outras_Licenca - Copiar", Splitter.SplitTextByDelimiter(" - ", QuoteStyle.Csv), {"Outras_Licenca - Copiar.1", "Outras_Licenca - Copiar.2"}),
    #"Tipo Alterado2" = Table.TransformColumnTypes(#"Dividir Coluna por Delimitador",{{"Outras_Licenca - Copiar.1", type date}, {"Outras_Licenca - Copiar.2", type date}}),
    #"Colunas Renomeadas1" = Table.RenameColumns(#"Tipo Alterado2",{{"Outras_Licenca - Copiar.1", "Outras_Licenca_Inicio"}, {"Outras_Licenca - Copiar.2", "Outras_Licenca_Fim"}}),
    #"Coluna Duplicada3" = Table.DuplicateColumn(#"Colunas Renomeadas1", "Outras_Licenca_Inicio", "Outras_Licenca_Inicio - Copiar"),
    #"Coluna Duplicada4" = Table.DuplicateColumn(#"Coluna Duplicada3", "Outras_Licenca_Inicio - Copiar", "Outras_Licenca_Inicio - Copiar - Copiar"),
    #"Mês Extraído" = Table.TransformColumns(#"Coluna Duplicada4",{{"Outras_Licenca_Inicio - Copiar", Date.Month, Int64.Type}}),
    #"Nome do Mês Extraído" = Table.TransformColumns(#"Mês Extraído", {{"Outras_Licenca_Inicio - Copiar - Copiar", each Date.MonthName(_), type text}}),
    #"Colunas Reordenadas3" = Table.ReorderColumns(#"Nome do Mês Extraído",{"SGPBT06_NUMR_MATR_SERV", "Outras_Licenca", "Outras_Licenca_Inicio", "Outras_Licenca_Fim", "Outras_Licenca_Inicio - Copiar", "Outras_Licenca_Inicio - Copiar - Copiar", "NUMR_SEQ_OUTRO_AFASTAMENTO", "Outras_Licenca_Ano", "TIPO_AFASTAMENTO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "QTDE_MESES", "NUMR_PROCESSO", "DATA_ATUALIZACAO_BD"}),
    #"Colunas Renomeadas2" = Table.RenameColumns(#"Colunas Reordenadas3",{{"Outras_Licenca_Inicio - Copiar", "Num_Mes"}, {"Outras_Licenca_Inicio - Copiar - Copiar", "Outras_Licenca_Mes"}}),
    #"Linhas Filtradas" = Table.SelectRows(#"Colunas Renomeadas2", each ([CODG_SITUACAO_REGISTRO] = 1))
in
    #"Linhas Filtradas"
