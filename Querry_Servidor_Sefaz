let
    Fonte = Excel.Workbook(File.Contents("C:\Users\xxxxxxxx\Documents\My SAS Files\FERIAS E LP\SGPTB06_SERVIDOR_SEFAZ.xlsx"), null, true),
    SGPTB06_SERVIDOR_SEFAZ_Sheet = Fonte{[Item="SGPTB06_SERVIDOR_SEFAZ",Kind="Sheet"]}[Data],
    #"Cabeçalhos Promovidos" = Table.PromoteHeaders(SGPTB06_SERVIDOR_SEFAZ_Sheet, [PromoteAllScalars=true]),
    #"Colunas Reordenadas" = Table.ReorderColumns(#"Cabeçalhos Promovidos",{"TIPO_SERVIDOR", "NUMR_MATR_SERV", "NOME_SERVIDOR", "CODG_CLASSE_CARGO", "REFR_CARGO", "ENDR_ELET_ORGANIZACIONAL", "ENDR_ELET_PARTICULAR", "NUMR_RG", "DESC_ORGAO_EXPEDIDOR_RG", "DATA_EMISSAO_RG", "NUMR_CPF", "ACCTB14_SIGL_UF_RG", "SGPTB07_NUMR_CARGO_SEQC", "SGPTB08_NUMR_CARGO_CMSS_SEQC", "DATA_INICIO_LOTACAO", "SGPTB22_CODG_UNIDADE", "CODG_SITUACAO_REGISTRO", "DESC_OBSERVACAO_LOTACAO", "CODG_BANCO", "NUMR_AGENCIA", "CODG_DV_AGENCIA", "NUMR_CONTA_CORRENTE", "CODG_DV_CONTA_CORRENTE", "NUMR_IDEN_NOTES", "SGPTB10_CODG_CONTRATO_SEQC", "NUMR_MATR_SERV_ORGAO_ORIGEM", "NUMR_CRACHA", "DATA_PUBLICACAO_DOE", "DATA_ADMISSAO", "ACCTB06_CODG_SEQC_ENDERECO", "DATA_NASCIMENTO", "FLAG_CARTAO_BB", "ACCTB14_SIGL_UF_NATURALIDADE", "ACCTB14_SIGL_UF_CART_PRFS", "ACCTB14_SIGL_UF_TITULO_ELEITOR", "NOME_PAI", "NOME_MAE", "CODG_ESTADO_CIVIL", "DESC_NACIONALIDADE", "DESC_CIDADE_NATURALIDADE", "TIPO_SANGUINEO", "NUMR_DDD_CELULAR", "NUMR_CELULAR", "NOME_AVISAR_EMGC", "NUMR_DDD_TEL_AVISAR_EMGC", "NUMR_TEL_AVISAR_EMGC", "NUMR_DDD_CEL_AVISAR_EMGC", "NUMR_CEL_AVISAR_EMGC", "NUMR_CART_PRFS", "NUMR_SERIE_CART_PRFS", "NUMR_PIS_PASEP", "NUMR_TITULO_ELEITOR", "NUMR_ZONA_TITULO_ELEITOR", "NUMR_SECAO_TITULO_ELEITOR", "NUMR_DOCT_MILITAR", "CATG_DOCT_MILITAR", "CODG_MNST_DOCT_MILITAR", "CODG_GRAU_INSTRUCAO", "DATA_INAT_SERVIDOR", "FLAG_PNE", "FLAG_SEXO", "NUMR_MATR_ORGA_ORIG_ATUAL", "DATA_BASE_PRDO_AQSC_FERIAS", "TIPO_MARCACAO_PONTO", "SGPTB45_CODG_ESCALA_SEQC", "DATA_INICIO_ESCALA", "SGPTB46_CODG_JORNADA_SEQC", "DATA_INICIO_JORNADA", "SGPTB51_NUMR_PERF_CARGO_SEQC", "DATA_INICIO_CARGO", "DATA_INIC_TIPO_MARCACAO_PONTO", "DATA_INICIO_VINCULO_FUNCIONAL", "NOME_SEM_ABRV_ACENTOS", "CODG_CREDOR", "DESC_ORGAO_ORIGEM", "DATA_ATUALIZACAO_BD", "CODG_TIPO_PONTO_OFICIAL_SHEL"}),
    #"Colunas Reordenadas1" = Table.ReorderColumns(#"Colunas Reordenadas",{"DATA_INAT_SERVIDOR", "TIPO_SERVIDOR", "NUMR_MATR_SERV", "NOME_SERVIDOR", "CODG_CLASSE_CARGO", "REFR_CARGO", "ENDR_ELET_ORGANIZACIONAL", "ENDR_ELET_PARTICULAR", "NUMR_RG", "DESC_ORGAO_EXPEDIDOR_RG", "DATA_EMISSAO_RG", "NUMR_CPF", "ACCTB14_SIGL_UF_RG", "SGPTB07_NUMR_CARGO_SEQC", "SGPTB08_NUMR_CARGO_CMSS_SEQC", "DATA_INICIO_LOTACAO", "SGPTB22_CODG_UNIDADE", "CODG_SITUACAO_REGISTRO", "DESC_OBSERVACAO_LOTACAO", "CODG_BANCO", "NUMR_AGENCIA", "CODG_DV_AGENCIA", "NUMR_CONTA_CORRENTE", "CODG_DV_CONTA_CORRENTE", "NUMR_IDEN_NOTES", "SGPTB10_CODG_CONTRATO_SEQC", "NUMR_MATR_SERV_ORGAO_ORIGEM", "NUMR_CRACHA", "DATA_PUBLICACAO_DOE", "DATA_ADMISSAO", "ACCTB06_CODG_SEQC_ENDERECO", "DATA_NASCIMENTO", "FLAG_CARTAO_BB", "ACCTB14_SIGL_UF_NATURALIDADE", "ACCTB14_SIGL_UF_CART_PRFS", "ACCTB14_SIGL_UF_TITULO_ELEITOR", "NOME_PAI", "NOME_MAE", "CODG_ESTADO_CIVIL", "DESC_NACIONALIDADE", "DESC_CIDADE_NATURALIDADE", "TIPO_SANGUINEO", "NUMR_DDD_CELULAR", "NUMR_CELULAR", "NOME_AVISAR_EMGC", "NUMR_DDD_TEL_AVISAR_EMGC", "NUMR_TEL_AVISAR_EMGC", "NUMR_DDD_CEL_AVISAR_EMGC", "NUMR_CEL_AVISAR_EMGC", "NUMR_CART_PRFS", "NUMR_SERIE_CART_PRFS", "NUMR_PIS_PASEP", "NUMR_TITULO_ELEITOR", "NUMR_ZONA_TITULO_ELEITOR", "NUMR_SECAO_TITULO_ELEITOR", "NUMR_DOCT_MILITAR", "CATG_DOCT_MILITAR", "CODG_MNST_DOCT_MILITAR", "CODG_GRAU_INSTRUCAO", "FLAG_PNE", "FLAG_SEXO", "NUMR_MATR_ORGA_ORIG_ATUAL", "DATA_BASE_PRDO_AQSC_FERIAS", "TIPO_MARCACAO_PONTO", "SGPTB45_CODG_ESCALA_SEQC", "DATA_INICIO_ESCALA", "SGPTB46_CODG_JORNADA_SEQC", "DATA_INICIO_JORNADA", "SGPTB51_NUMR_PERF_CARGO_SEQC", "DATA_INICIO_CARGO", "DATA_INIC_TIPO_MARCACAO_PONTO", "DATA_INICIO_VINCULO_FUNCIONAL", "NOME_SEM_ABRV_ACENTOS", "CODG_CREDOR", "DESC_ORGAO_ORIGEM", "DATA_ATUALIZACAO_BD", "CODG_TIPO_PONTO_OFICIAL_SHEL"}),
    #"Tipo Alterado3" = Table.TransformColumnTypes(#"Colunas Reordenadas1",{{"DATA_PUBLICACAO_DOE", type date}, {"DATA_ADMISSAO", type date}}),
    #"Colunas Reordenadas2" = Table.ReorderColumns(#"Tipo Alterado3",{"NUMR_MATR_SERV", "NOME_SERVIDOR", "SGPTB22_CODG_UNIDADE", "DATA_INAT_SERVIDOR", "TIPO_SERVIDOR", "CODG_CLASSE_CARGO", "REFR_CARGO", "ENDR_ELET_ORGANIZACIONAL", "ENDR_ELET_PARTICULAR", "NUMR_RG", "DESC_ORGAO_EXPEDIDOR_RG", "DATA_EMISSAO_RG", "NUMR_CPF", "ACCTB14_SIGL_UF_RG", "SGPTB07_NUMR_CARGO_SEQC", "SGPTB08_NUMR_CARGO_CMSS_SEQC", "DATA_INICIO_LOTACAO", "CODG_SITUACAO_REGISTRO", "DESC_OBSERVACAO_LOTACAO", "CODG_BANCO", "NUMR_AGENCIA", "CODG_DV_AGENCIA", "NUMR_CONTA_CORRENTE", "CODG_DV_CONTA_CORRENTE", "NUMR_IDEN_NOTES", "SGPTB10_CODG_CONTRATO_SEQC", "NUMR_MATR_SERV_ORGAO_ORIGEM", "NUMR_CRACHA", "DATA_PUBLICACAO_DOE", "DATA_ADMISSAO", "ACCTB06_CODG_SEQC_ENDERECO", "DATA_NASCIMENTO", "FLAG_CARTAO_BB", "ACCTB14_SIGL_UF_NATURALIDADE", "ACCTB14_SIGL_UF_CART_PRFS", "ACCTB14_SIGL_UF_TITULO_ELEITOR", "NOME_PAI", "NOME_MAE", "CODG_ESTADO_CIVIL", "DESC_NACIONALIDADE", "DESC_CIDADE_NATURALIDADE", "TIPO_SANGUINEO", "NUMR_DDD_CELULAR", "NUMR_CELULAR", "NOME_AVISAR_EMGC", "NUMR_DDD_TEL_AVISAR_EMGC", "NUMR_TEL_AVISAR_EMGC", "NUMR_DDD_CEL_AVISAR_EMGC", "NUMR_CEL_AVISAR_EMGC", "NUMR_CART_PRFS", "NUMR_SERIE_CART_PRFS", "NUMR_PIS_PASEP", "NUMR_TITULO_ELEITOR", "NUMR_ZONA_TITULO_ELEITOR", "NUMR_SECAO_TITULO_ELEITOR", "NUMR_DOCT_MILITAR", "CATG_DOCT_MILITAR", "CODG_MNST_DOCT_MILITAR", "CODG_GRAU_INSTRUCAO", "FLAG_PNE", "FLAG_SEXO", "NUMR_MATR_ORGA_ORIG_ATUAL", "DATA_BASE_PRDO_AQSC_FERIAS", "TIPO_MARCACAO_PONTO", "SGPTB45_CODG_ESCALA_SEQC", "DATA_INICIO_ESCALA", "SGPTB46_CODG_JORNADA_SEQC", "DATA_INICIO_JORNADA", "SGPTB51_NUMR_PERF_CARGO_SEQC", "DATA_INICIO_CARGO", "DATA_INIC_TIPO_MARCACAO_PONTO", "DATA_INICIO_VINCULO_FUNCIONAL", "NOME_SEM_ABRV_ACENTOS", "CODG_CREDOR", "DESC_ORGAO_ORIGEM", "DATA_ATUALIZACAO_BD", "CODG_TIPO_PONTO_OFICIAL_SHEL"}),
    #"Linhas Classificadas" = Table.Sort(#"Colunas Reordenadas2",{{"NOME_SERVIDOR", Order.Ascending}}),
    #"Linhas Filtradas" = Table.SelectRows(#"Linhas Classificadas", each ([SGPTB22_CODG_UNIDADE] = 1717 or [SGPTB22_CODG_UNIDADE] = 1718 or [SGPTB22_CODG_UNIDADE] = 1719)),
    #"Colunas Reordenadas3" = Table.ReorderColumns(#"Linhas Filtradas",{"NUMR_MATR_SERV", "NOME_SERVIDOR", "SGPTB22_CODG_UNIDADE", "DATA_INAT_SERVIDOR", "TIPO_SERVIDOR", "CODG_CLASSE_CARGO", "REFR_CARGO", "ENDR_ELET_ORGANIZACIONAL", "ENDR_ELET_PARTICULAR", "NUMR_RG", "DESC_ORGAO_EXPEDIDOR_RG", "DATA_EMISSAO_RG", "NUMR_CPF", "ACCTB14_SIGL_UF_RG", "SGPTB07_NUMR_CARGO_SEQC", "SGPTB08_NUMR_CARGO_CMSS_SEQC", "DATA_INICIO_LOTACAO", "DESC_OBSERVACAO_LOTACAO", "CODG_BANCO", "NUMR_AGENCIA", "CODG_DV_AGENCIA", "NUMR_CONTA_CORRENTE", "CODG_DV_CONTA_CORRENTE", "NUMR_IDEN_NOTES", "SGPTB10_CODG_CONTRATO_SEQC", "NUMR_MATR_SERV_ORGAO_ORIGEM", "NUMR_CRACHA", "DATA_PUBLICACAO_DOE", "DATA_ADMISSAO", "ACCTB06_CODG_SEQC_ENDERECO", "DATA_NASCIMENTO", "FLAG_CARTAO_BB", "ACCTB14_SIGL_UF_NATURALIDADE", "ACCTB14_SIGL_UF_CART_PRFS", "ACCTB14_SIGL_UF_TITULO_ELEITOR", "NOME_PAI", "NOME_MAE", "CODG_ESTADO_CIVIL", "DESC_NACIONALIDADE", "DESC_CIDADE_NATURALIDADE", "TIPO_SANGUINEO", "NUMR_DDD_CELULAR", "NUMR_CELULAR", "NOME_AVISAR_EMGC", "NUMR_DDD_TEL_AVISAR_EMGC", "NUMR_TEL_AVISAR_EMGC", "NUMR_DDD_CEL_AVISAR_EMGC", "NUMR_CEL_AVISAR_EMGC", "NUMR_CART_PRFS", "NUMR_SERIE_CART_PRFS", "NUMR_PIS_PASEP", "NUMR_TITULO_ELEITOR", "NUMR_ZONA_TITULO_ELEITOR", "NUMR_SECAO_TITULO_ELEITOR", "NUMR_DOCT_MILITAR", "CATG_DOCT_MILITAR", "CODG_MNST_DOCT_MILITAR", "CODG_GRAU_INSTRUCAO", "FLAG_PNE", "FLAG_SEXO", "NUMR_MATR_ORGA_ORIG_ATUAL", "DATA_BASE_PRDO_AQSC_FERIAS", "TIPO_MARCACAO_PONTO", "SGPTB45_CODG_ESCALA_SEQC", "DATA_INICIO_ESCALA", "SGPTB46_CODG_JORNADA_SEQC", "DATA_INICIO_JORNADA", "SGPTB51_NUMR_PERF_CARGO_SEQC", "DATA_INICIO_CARGO", "DATA_INIC_TIPO_MARCACAO_PONTO", "DATA_INICIO_VINCULO_FUNCIONAL", "NOME_SEM_ABRV_ACENTOS", "CODG_CREDOR", "DESC_ORGAO_ORIGEM", "DATA_ATUALIZACAO_BD", "CODG_TIPO_PONTO_OFICIAL_SHEL", "CODG_SITUACAO_REGISTRO"}),
    #"Linhas Classificadas1" = Table.Sort(#"Colunas Reordenadas3",{{"SGPTB22_CODG_UNIDADE", Order.Ascending}}),
    #"Linhas Filtradas1" = Table.SelectRows(#"Linhas Classificadas1", each [NOME_SERVIDOR] <> "ALLAN BATISTA CAMILO" and [NOME_SERVIDOR] <> "BENEDITO HENRIQUE DE CARVALHO NETO" and [NOME_SERVIDOR] <> "CARLOS MAGNO KNEIP ROSA" and [NOME_SERVIDOR] <> "CESAR RUBENS GONÇALVES" and [NOME_SERVIDOR] <> "CHRISTIANO ALEXANDRE GONCALVES DE SOUZA" and [NOME_SERVIDOR] <> "CLAYTON FERREIRA LEÃO" and [NOME_SERVIDOR] <> "DANIELE YUKIE FUKUI REBOUCAS" and [NOME_SERVIDOR] <> "DJANGO LEONE FERREIRA" and [NOME_SERVIDOR] <> "EDER PIRES CAMARGO" and [NOME_SERVIDOR] <> "EDERALDO JOSE PEREIRA DE LIMA" and [NOME_SERVIDOR] <> "EDVALDO BELISARIO DOS SANTOS" and [NOME_SERVIDOR] <> "ELIZETE ARAUJO RAMOS SOUZA" and [NOME_SERVIDOR] <> "EREMITA LAURA DA SILVA OURIVES" and [NOME_SERVIDOR] <> "FREDERICO AUGUSTO ALVES FELICIANO DE SOUSA" and [NOME_SERVIDOR] <> "GEANNE FABIA SUBTIL DE OLIVEIRA" and [NOME_SERVIDOR] <> "GILBERTO SIQUEIRA ARANTES" and [NOME_SERVIDOR] <> "GISELI ALVES SILVENTE" and [NOME_SERVIDOR] <> "JOAO VICTOR FARIAS TAVEIRA" and [NOME_SERVIDOR] <> "JODEON SAMPAIO SILVA" and [NOME_SERVIDOR] <> "JOSE CARLOS FERREIRA DA SILVA" and [NOME_SERVIDOR] <> "JOSE LUIZ DE ARRUDA" and [NOME_SERVIDOR] <> "JUDSON GOMES DA SILVA BASTOS" and [NOME_SERVIDOR] <> "JURANDIR BRITO DA SILVA" and [NOME_SERVIDOR] <> "KIMBERLLY KEWENY SOUZA DE DEUS" and [NOME_SERVIDOR] <> "LIRENE BATISTA ESPINDOLA" and [NOME_SERVIDOR] <> "LUIZ EDUARDO BILIBIO PIVA" and [NOME_SERVIDOR] <> "LUIZ SANTOS DA SILVA" and [NOME_SERVIDOR] <> "LUIZ SILVIO TRIPOTTI BATTISTETTI" and [NOME_SERVIDOR] <> "MARILAINE PINHEIRO DE MELLO" and [NOME_SERVIDOR] <> "MARIO EDUARDO MARQUARDT" and [NOME_SERVIDOR] <> "MILENA SOARES ALVES" and [NOME_SERVIDOR] <> "MONICKE SANT ANNA PINTO DE ARRUDA" and [NOME_SERVIDOR] <> "ORIVALDO DIAS DE SOUZA" and [NOME_SERVIDOR] <> "PEDRO CARLOS MILER" and [NOME_SERVIDOR] <> "SERGIO JOSE GOMES" and [NOME_SERVIDOR] <> "SIGUINEI SUCH" and [NOME_SERVIDOR] <> "SONIA MARIA FISCHER MARINHO" and [NOME_SERVIDOR] <> "TATIANA MONTEIRO COSTA E SILVA" and [NOME_SERVIDOR] <> "THIAGO DAYAN DA LUZ BARROS" and [NOME_SERVIDOR] <> "VITOR DE OLIVEIRA TAVARES" and [NOME_SERVIDOR] <> "ZULMA SANT'ANNA DE CARVALHO" and [NOME_SERVIDOR] <> "IRONE GALINDO CADEMARTORI"),
    #"Outras Colunas Removidas" = Table.SelectColumns(#"Linhas Filtradas1",{"NUMR_MATR_SERV", "NOME_SERVIDOR", "SGPTB22_CODG_UNIDADE", "DATA_INAT_SERVIDOR", "TIPO_SERVIDOR", "CODG_CLASSE_CARGO", "REFR_CARGO", "SGPTB07_NUMR_CARGO_SEQC", "DATA_INICIO_LOTACAO", "DESC_OBSERVACAO_LOTACAO", "NUMR_MATR_SERV_ORGAO_ORIGEM", "DATA_ADMISSAO", "NUMR_MATR_ORGA_ORIG_ATUAL", "DATA_BASE_PRDO_AQSC_FERIAS", "DESC_ORGAO_ORIGEM", "DATA_ATUALIZACAO_BD"}),
    #"Tipo Alterado" = Table.TransformColumnTypes(#"Outras Colunas Removidas",{{"DATA_INICIO_LOTACAO", type datetime}}),
    #"Tipo Alterado1" = Table.TransformColumnTypes(#"Tipo Alterado",{{"DATA_INICIO_LOTACAO", type date}, {"DATA_BASE_PRDO_AQSC_FERIAS", type date}}),
    #"Colunas Reordenadas4" = Table.ReorderColumns(#"Tipo Alterado1",{"NUMR_MATR_SERV", "NOME_SERVIDOR", "SGPTB07_NUMR_CARGO_SEQC", "SGPTB22_CODG_UNIDADE", "DATA_INAT_SERVIDOR", "TIPO_SERVIDOR", "CODG_CLASSE_CARGO", "REFR_CARGO", "DATA_INICIO_LOTACAO", "DESC_OBSERVACAO_LOTACAO", "NUMR_MATR_SERV_ORGAO_ORIGEM", "DATA_ADMISSAO", "NUMR_MATR_ORGA_ORIG_ATUAL", "DATA_BASE_PRDO_AQSC_FERIAS", "DESC_ORGAO_ORIGEM", "DATA_ATUALIZACAO_BD"}),
    #"Tipo Alterado2" = Table.TransformColumnTypes(#"Colunas Reordenadas4",{{"DATA_ATUALIZACAO_BD", type datetime}}),
    #"Tipo Alterado4" = Table.TransformColumnTypes(#"Tipo Alterado2",{{"DATA_ATUALIZACAO_BD", type date}}),
    #"Linhas Classificadas2" = Table.Sort(#"Tipo Alterado4",{{"NOME_SERVIDOR", Order.Ascending}})
in
    #"Linhas Classificadas2"
