let
    Fonte = Excel.Workbook(File.Contents("C:\Users\xxxxxxxx\Documents\My SAS Files\FERIAS E LP\SGPTB17_GOZO_LICENCA_PREMIO.xlsx"), null, true),
    SGPTB17_GOZO_LICENCA_PREMIO_Sheet = Fonte{[Item="SGPTB17_GOZO_LICENCA_PREMIO",Kind="Sheet"]}[Data],
    #"Cabeçalhos Promovidos" = Table.PromoteHeaders(SGPTB17_GOZO_LICENCA_PREMIO_Sheet, [PromoteAllScalars=true]),
    #"Tipo Alterado" = Table.TransformColumnTypes(#"Cabeçalhos Promovidos",{{"NUMR_SEQC_GOZO", Int64.Type}, {"SGPTB16_SEQC_LICENCA_PREMIO", Int64.Type}, {"NUMR_PROCESSO", type text}, {"DATA_PROCESSO", type datetime}, {"DATA_INICIO_GOZO", type datetime}, {"DATA_FIM_GOZO", type datetime}, {"QTDE_MESES_GOZO", Int64.Type}, {"DESC_OBSERVACAO", type text}, {"CODG_SITUACAO_REGISTRO", Int64.Type}, {"TIPO_USUFRUTO", Int64.Type}, {"DATA_INIC_USUFRUTO", type datetime}, {"DATA_FIM_USUFRUTO", type datetime}, {"HORA_INICIO_CHD_REDUZIDA", type text}, {"HORA_FIM_CHD_REDUZIDA", type text}, {"HORA_INICIO_CHD_COM_TOLERANCIA", type text}, {"HORA_FIM_CHD_COM_TOLERANCIA", type text}, {"DATA_ATUALIZACAO_BD", type datetime}, {"QTDE_DIAS_GOZO", Int64.Type}, {"QTDE_DIAS_USUFRUTO", type text}, {"TMP_TIPO_USUFRUTO", type text}, {"TMP_ANTIGA_DATA_INICIO_GOZO", type text}, {"TMP_ANTIGA_DATA_FIM_GOZO", type text}}),
    #"Tipo Alterado1" = Table.TransformColumnTypes(#"Tipo Alterado",{{"DATA_PROCESSO", type date}, {"DATA_INICIO_GOZO", type date}, {"DATA_FIM_GOZO", type date}, {"DATA_INIC_USUFRUTO", type date}, {"DATA_FIM_USUFRUTO", type date}, {"DATA_ATUALIZACAO_BD", type date}}),
    #"Linhas Classificadas" = Table.Sort(#"Tipo Alterado1",{{"DATA_ATUALIZACAO_BD", Order.Descending}}),
    #"Outras Colunas Removidas" = Table.SelectColumns(#"Linhas Classificadas",{"NUMR_SEQC_GOZO", "SGPTB16_SEQC_LICENCA_PREMIO", "NUMR_PROCESSO", "DATA_PROCESSO", "DATA_INICIO_GOZO", "DATA_FIM_GOZO", "QTDE_MESES_GOZO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "TIPO_USUFRUTO", "DATA_INIC_USUFRUTO", "DATA_FIM_USUFRUTO", "DATA_ATUALIZACAO_BD", "QTDE_DIAS_GOZO", "QTDE_DIAS_USUFRUTO"}),
    #"Colunas Mescladas" = Table.CombineColumns(Table.TransformColumnTypes(#"Outras Colunas Removidas", {{"DATA_INICIO_GOZO", type text}, {"DATA_FIM_GOZO", type text}}, "pt-BR"),{"DATA_INICIO_GOZO", "DATA_FIM_GOZO"},Combiner.CombineTextByDelimiter(" - ", QuoteStyle.None),"Licenca_Premio"),
    #"Colunas Reordenadas" = Table.ReorderColumns(#"Colunas Mescladas",{"NUMR_SEQC_GOZO", "SGPTB16_SEQC_LICENCA_PREMIO", "NUMR_PROCESSO", "DATA_PROCESSO", "DATA_INIC_USUFRUTO", "DATA_FIM_USUFRUTO", "Licenca_Premio", "QTDE_MESES_GOZO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "TIPO_USUFRUTO", "DATA_ATUALIZACAO_BD", "QTDE_DIAS_GOZO", "QTDE_DIAS_USUFRUTO"}),
    #"Outras Colunas Removidas1" = Table.SelectColumns(#"Colunas Reordenadas",{"NUMR_SEQC_GOZO", "SGPTB16_SEQC_LICENCA_PREMIO", "NUMR_PROCESSO", "DATA_PROCESSO", "Licenca_Premio", "QTDE_MESES_GOZO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "TIPO_USUFRUTO", "DATA_ATUALIZACAO_BD", "QTDE_DIAS_GOZO", "QTDE_DIAS_USUFRUTO"}),
    #"Colunas Reordenadas1" = Table.ReorderColumns(#"Outras Colunas Removidas1",{"NUMR_SEQC_GOZO", "SGPTB16_SEQC_LICENCA_PREMIO", "Licenca_Premio", "NUMR_PROCESSO", "DATA_PROCESSO", "QTDE_MESES_GOZO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "TIPO_USUFRUTO", "DATA_ATUALIZACAO_BD", "QTDE_DIAS_GOZO", "QTDE_DIAS_USUFRUTO"}),
    #"Coluna Duplicada" = Table.DuplicateColumn(#"Colunas Reordenadas1", "Licenca_Premio", "Licenca_Premio - Copiar"),
    #"Colunas Reordenadas2" = Table.ReorderColumns(#"Coluna Duplicada",{"NUMR_SEQC_GOZO", "SGPTB16_SEQC_LICENCA_PREMIO", "Licenca_Premio", "Licenca_Premio - Copiar", "NUMR_PROCESSO", "DATA_PROCESSO", "QTDE_MESES_GOZO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "TIPO_USUFRUTO", "DATA_ATUALIZACAO_BD", "QTDE_DIAS_GOZO", "QTDE_DIAS_USUFRUTO"}),
    #"Colunas Renomeadas" = Table.RenameColumns(#"Colunas Reordenadas2",{{"Licenca_Premio - Copiar", "Licenca_Premio_Ano"}}),
    #"Últimos caracteres extraídos" = Table.TransformColumns(#"Colunas Renomeadas", {{"Licenca_Premio_Ano", each Text.End(_, 4), type text}}),
    #"Coluna Duplicada1" = Table.DuplicateColumn(#"Últimos caracteres extraídos", "Licenca_Premio", "Licenca_Premio - Copiar"),
    #"Colunas Reordenadas3" = Table.ReorderColumns(#"Coluna Duplicada1",{"NUMR_SEQC_GOZO", "SGPTB16_SEQC_LICENCA_PREMIO", "Licenca_Premio", "Licenca_Premio - Copiar", "Licenca_Premio_Ano", "NUMR_PROCESSO", "DATA_PROCESSO", "QTDE_MESES_GOZO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "TIPO_USUFRUTO", "DATA_ATUALIZACAO_BD", "QTDE_DIAS_GOZO", "QTDE_DIAS_USUFRUTO"}),
    #"Dividir Coluna por Delimitador" = Table.SplitColumn(#"Colunas Reordenadas3", "Licenca_Premio - Copiar", Splitter.SplitTextByDelimiter(" - ", QuoteStyle.Csv), {"Licenca_Premio - Copiar.1", "Licenca_Premio - Copiar.2"}),
    #"Tipo Alterado2" = Table.TransformColumnTypes(#"Dividir Coluna por Delimitador",{{"Licenca_Premio - Copiar.1", type date}, {"Licenca_Premio - Copiar.2", type date}}),
    #"Colunas Renomeadas1" = Table.RenameColumns(#"Tipo Alterado2",{{"Licenca_Premio - Copiar.1", "Licenca_Premio_Inicio"}, {"Licenca_Premio - Copiar.2", "Licenca_Premio_Fim"}}),
    #"Coluna Duplicada2" = Table.DuplicateColumn(#"Colunas Renomeadas1", "Licenca_Premio_Inicio", "Licenca_Premio_Inicio - Copiar"),
    #"Colunas Reordenadas4" = Table.ReorderColumns(#"Coluna Duplicada2",{"NUMR_SEQC_GOZO", "SGPTB16_SEQC_LICENCA_PREMIO", "Licenca_Premio", "Licenca_Premio_Inicio", "Licenca_Premio_Fim", "Licenca_Premio_Inicio - Copiar", "Licenca_Premio_Ano", "NUMR_PROCESSO", "DATA_PROCESSO", "QTDE_MESES_GOZO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "TIPO_USUFRUTO", "DATA_ATUALIZACAO_BD", "QTDE_DIAS_GOZO", "QTDE_DIAS_USUFRUTO"}),
    #"Nome do Mês Extraído" = Table.TransformColumns(#"Colunas Reordenadas4", {{"Licenca_Premio_Inicio - Copiar", each Date.MonthName(_), type text}}),
    #"Colunas Renomeadas2" = Table.RenameColumns(#"Nome do Mês Extraído",{{"Licenca_Premio_Inicio - Copiar", "Licenca_Premio_Mes"}}),
    #"Coluna Duplicada3" = Table.DuplicateColumn(#"Colunas Renomeadas2", "Licenca_Premio_Fim", "Licenca_Premio_Fim - Copiar"),
    #"Colunas Reordenadas5" = Table.ReorderColumns(#"Coluna Duplicada3",{"NUMR_SEQC_GOZO", "SGPTB16_SEQC_LICENCA_PREMIO", "Licenca_Premio", "Licenca_Premio_Inicio", "Licenca_Premio_Fim", "Licenca_Premio_Fim - Copiar", "Licenca_Premio_Mes", "Licenca_Premio_Ano", "NUMR_PROCESSO", "DATA_PROCESSO", "QTDE_MESES_GOZO", "DESC_OBSERVACAO", "CODG_SITUACAO_REGISTRO", "TIPO_USUFRUTO", "DATA_ATUALIZACAO_BD", "QTDE_DIAS_GOZO", "QTDE_DIAS_USUFRUTO"}),
    #"Mês Extraído" = Table.TransformColumns(#"Colunas Reordenadas5",{{"Licenca_Premio_Fim - Copiar", Date.Month, Int64.Type}}),
    #"Colunas Renomeadas3" = Table.RenameColumns(#"Mês Extraído",{{"Licenca_Premio_Fim - Copiar", "Num_Mes"}}),
    #"Linhas Filtradas" = Table.SelectRows(#"Colunas Renomeadas3", each ([CODG_SITUACAO_REGISTRO] = 1))
in
    #"Linhas Filtradas"
